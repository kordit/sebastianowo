[2025-05-06 20:12:08] [DEBUG] ===== ROZPOCZĘCIE PRZETWARZANIA ŻĄDANIA DIALOGU =====
[2025-05-06 20:12:08] [DEBUG] Żądanie dialogu: NPC ID: 449, Dialog ID: inny-dialog, User ID: 1
[2025-05-06 20:12:08] [INFO] WSZYSTKIE DANE ŻĄDANIA:
[2025-05-06 20:12:08] [DATA] Array
(
    [page_data] => Array
        (
        )

    [npc_id] => 449
    [dialog_id] => inny-dialog
    [current_url] => http://seb.soeasy.it/tereny/park/
    [user_id] => 1
    [answer_id] => answer-1
    [answer_index] => 1
    [current_dialog_id] => misja
)

[2025-05-06 20:12:08] [DEBUG] Dane odpowiedzi: ID: answer-1, Index: 1, Poprzedni dialog: misja
[2025-05-06 20:12:08] [INFO] STAN PLECAKA PRZED PRZETWARZANIEM DIALOGU:
[2025-05-06 20:12:08] [DATA] Array
(
    [gold] => 50
    [cigarettes] => 10
)

[2025-05-06 20:12:08] [INFO] Pobrane dialogi dla NPC 449
[2025-05-06 20:12:08] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_task
                                    [condition] => is
                                    [mission_id] => 247
                                    [task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [status] => completed
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Misja
            [id_pola] => misja
            [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Tutaj dajemy odpowiedź
                            [type_anwser] => 
                            [go_to_id] => inny-dialog
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Misja
                            [type_anwser] => Array
                                (
                                    [0] => Array
                                        (
                                            [acf_fc_layout] => mission
                                            [acfe_flexible_toggle] => 
                                            [mission_id] => 247
                                            [mission_status] => in_progress
                                            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                            [mission_task_status] => in_progress_npc
                                        )

                                )

                            [go_to_id] => inny-dialog
                        )

                )

        )

    [1] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_location
                                    [condition] => is
                                    [location_type] => text
                                    [area] => 
                                    [location_text] => park/main
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => dialog-na-zamku
            [id_pola] => dialog-na-zamku
            [question] => <p>dialog na zamku</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => elo
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [2] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_inventory
                                    [condition] => has_not_item
                                    [item_id] => 123
                                    [quantity] => 1
                                )

                            [1] => Array
                                (
                                    [acf_fc_layout] => condition_inventory
                                    [condition] => has_item
                                    [item_id] => 156
                                    [quantity] => 1
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Przedmiot
            [id_pola] => przedmiot
            [question] => <p>przedmiot</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_inventory
                                                    [condition] => quantity_above
                                                    [item_id] => 156
                                                    [quantity] => 2
                                                )

                                        )

                                )

                            [anwser_text] => przedmiot mam
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => domyslny
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [3] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_npc_relation
                                    [condition] => relation_above
                                    [npc_id] => 449
                                    [relation_value] => 50
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Dialog
            [id_pola] => lubimy-sie
            [question] => <p>Lubimy sie</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => test
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [4] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_location
                                    [condition] => is
                                    [location_type] => text
                                    [area] => 
                                    [location_text] => park/main
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => nazwa-w-parku
            [id_pola] => nazwa-w-parku
            [question] => <p>Dialog w parku</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_location
                                                    [condition] => is
                                                    [location_type] => text
                                                    [area] => 
                                                    [location_text] => park/main
                                                )

                                        )

                                )

                            [anwser_text] => Odpowiedź w parku
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_location
                                                    [condition] => is
                                                    [location_type] => text
                                                    [area] => 
                                                    [location_text] => park/zamek
                                                )

                                        )

                                )

                            [anwser_text] => odpowiedź w zamku
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [2] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Domyślna
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [5] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => domyslny
            [id_pola] => domyslny
            [question] => <p>Domyślny</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => domyslne
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [6] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Dialog
            [id_pola] => inny-dialog
            [question] => <p>tutaj inny dialog</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => ok
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

)

[2025-05-06 20:12:08] [INFO] Wyodrębnione dane lokalizacji:
[2025-05-06 20:12:08] [DATA] Array
(
    [location] => Array
        (
            [area_slug] => park
            [area_name] => Park
            [area_id] => 207
        )

    [type_page] => 
    [location_value] => 
)

[2025-05-06 20:12:08] [DEBUG] ROZPOCZYNAM PRZETWARZANIE PRZYCISKÓW ODPOWIEDZI
[2025-05-06 20:12:08] [DEBUG] Znaleziono dialog o ID: misja
[2025-05-06 20:12:08] [DEBUG] Znaleziono poprzedni dialog ID: misja
[2025-05-06 20:12:08] [INFO] Pełne dane dialogu:
[2025-05-06 20:12:08] [DATA] Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => condition_task
                            [condition] => is
                            [mission_id] => 247
                            [task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [status] => completed
                        )

                )

        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Misja
    [id_pola] => misja
    [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Tutaj dajemy odpowiedź
                    [type_anwser] => 
                    [go_to_id] => inny-dialog
                )

            [1] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Misja
                    [type_anwser] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => mission
                                    [acfe_flexible_toggle] => 
                                    [mission_id] => 247
                                    [mission_status] => in_progress
                                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [mission_task_status] => in_progress_npc
                                )

                        )

                    [go_to_id] => inny-dialog
                )

        )

)

[2025-05-06 20:12:08] [INFO] Odpowiedzi w dialogu:
[2025-05-06 20:12:08] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => anwser
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [anwser_text] => Tutaj dajemy odpowiedź
            [type_anwser] => 
            [go_to_id] => inny-dialog
        )

    [1] => Array
        (
            [acf_fc_layout] => anwser
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [anwser_text] => Misja
            [type_anwser] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => mission
                            [acfe_flexible_toggle] => 
                            [mission_id] => 247
                            [mission_status] => in_progress
                            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [mission_task_status] => in_progress_npc
                        )

                )

            [go_to_id] => inny-dialog
        )

)

[2025-05-06 20:12:08] [DEBUG] Znaleziono odpowiedź o indeksie: 1
[2025-05-06 20:12:08] [INFO] Dane odpowiedzi:
[2025-05-06 20:12:08] [DATA] Array
(
    [acf_fc_layout] => anwser
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [anwser_text] => Misja
    [type_anwser] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => mission
                    [acfe_flexible_toggle] => 
                    [mission_id] => 247
                    [mission_status] => in_progress
                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                    [mission_task_status] => in_progress_npc
                )

        )

    [go_to_id] => inny-dialog
)

[2025-05-06 20:12:08] [INFO] Odpowiedź zawiera akcje do wykonania:
[2025-05-06 20:12:08] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => mission
            [acfe_flexible_toggle] => 
            [mission_id] => 247
            [mission_status] => in_progress
            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
            [mission_task_status] => in_progress_npc
        )

)

[2025-05-06 20:12:08] [INFO] Przetwarzanie akcji:
[2025-05-06 20:12:08] [DATA] Array
(
    [acf_fc_layout] => mission
    [acfe_flexible_toggle] => 
    [mission_id] => 247
    [mission_status] => in_progress
    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
    [mission_task_status] => in_progress_npc
)

[2025-05-06 20:12:08] [DEBUG] Typ akcji: mission
[2025-05-06 20:12:08] [DEBUG] Wykonuję akcję misji: mission_id=247, status=in_progress, task_id=zidentyfikuj-potencjalnych-klientow_0, task_status=in_progress_npc, npc_id=449
[2025-05-06 20:12:08] [INFO] Aktualny stan misji użytkownika:
[2025-05-06 20:12:08] [DATA] Array
(
    [status] => in_progress
    [assigned_date] => 2025-04-27 13:05:30
    [completion_date] => 2025-04-29 16:43:16
    [tasks] => Array
        (
            [zidentyfikuj-potencjalnych-klientow_0] => Array
                (
                    [status] => completed
                    [npc_target_449] => progress
                    [npc_449] => progress
                )

            [rozlicz-sie-z-irasem_1] => not_started
        )

)

[2025-05-06 20:12:08] [DEBUG] Zaktualizowano status misji 'Flaszki od Dziadzi' z 'in_progress' na 'in_progress'
[2025-05-06 20:12:08] [DEBUG] Rozpoznano zadanie z NPC: task_id=zidentyfikuj-potencjalnych-klientow_0, npc_id=449
[2025-05-06 20:12:08] [DEBUG] Zaktualizowano status NPC 449 w zadaniu 'zidentyfikuj-potencjalnych-klientow_0' z 'progress' na 'in_progress'
[2025-05-06 20:12:08] [DEBUG] Rezultat update_field dla misji mission_247: BŁĄD
[2025-05-06 20:12:08] [INFO] Stan misji po aktualizacji:
[2025-05-06 20:12:08] [DATA] Array
(
    [status] => in_progress
    [assigned_date] => 2025-04-27 13:05:30
    [completion_date] => 2025-04-29 16:43:16
    [tasks] => Array
        (
            [zidentyfikuj-potencjalnych-klientow_0] => Array
                (
                    [status] => completed
                    [npc_target_449] => in_progress
                    [npc_449] => in_progress
                )

            [rozlicz-sie-z-irasem_1] => not_started
        )

)

[2025-05-06 20:12:08] [INFO] Utworzono powiadomienie dla misji:
[2025-05-06 20:12:08] [DATA] Array
(
    [message] => Rozpoczęto zadanie: zidentyfikuj-potencjalnych-klientow_0
    [status] => info
)

[2025-05-06 20:12:08] [INFO] Dialog po filtrowaniu:
[2025-05-06 20:12:08] [DATA] Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Dialog
    [id_pola] => inny-dialog
    [question] => <p>tutaj inny dialog</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => ok
                    [type_anwser] => 
                    [go_to_id] => 0
                )

        )

)

[2025-05-06 20:12:08] [DEBUG] Upraszczanie struktury dialogu: Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Dialog
    [id_pola] => inny-dialog
    [question] => <p>tutaj inny dialog</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => ok
                    [type_anwser] => 
                    [go_to_id] => 0
                )

        )

)

[2025-05-06 20:12:08] [DEBUG] Uproszczona struktura dialogu: Array
(
    [id] => inny-dialog
    [text] => <p>tutaj inny dialog</p>

    [answers] => Array
        (
            [0] => Array
                (
                    [id] => 
                    [text] => ok
                    [next_dialog] => 0
                )

        )

)

[2025-05-06 20:12:08] [INFO] Dodano powiadomienie do odpowiedzi:
[2025-05-06 20:12:08] [DATA] Array
(
    [message] => Rozpoczęto zadanie: zidentyfikuj-potencjalnych-klientow_0
    [status] => info
)

[2025-05-06 20:12:08] [INFO] Dane odpowiedzi:
[2025-05-06 20:12:08] [DATA] Array
(
    [success] => 1
    [dialog] => Array
        (
            [id] => inny-dialog
            [text] => <p>tutaj inny dialog</p>

            [answers] => Array
                (
                    [0] => Array
                        (
                            [id] => 
                            [text] => ok
                            [next_dialog] => 0
                        )

                )

        )

    [npc] => Array
        (
            [id] => 449
            [name] => Papuga
            [image] => http://seb.soeasy.it/wp-content/uploads/2025/04/papuga-1.png
        )

    [notification] => Array
        (
            [message] => Rozpoczęto zadanie: zidentyfikuj-potencjalnych-klientow_0
            [status] => info
        )

)

[2025-05-06 20:12:08] [DEBUG] ===== ZAKOŃCZENIE PRZETWARZANIA ŻĄDANIA DIALOGU =====
[2025-05-06 20:12:09] [DEBUG] Obsługa żądania danych użytkownika ID: 1
[2025-05-06 20:12:09] [INFO] Pobrano dane plecaka użytkownika:
[2025-05-06 20:12:09] [DATA] Array
(
    [gold] => 50
    [cigarettes] => 10
)

[2025-05-06 20:12:09] [INFO] Pobrano dane witalności użytkownika:
[2025-05-06 20:12:09] [DATA] Array
(
    [life] => 80
    [max_life] => 100
    [energy] => 70
    [max_energy] => 100
)

[2025-05-06 20:12:09] [INFO] Zwracam dane użytkownika:
[2025-05-06 20:12:09] [DATA] Array
(
    [success] => 1
    [message] => Dane użytkownika pobrane pomyślnie
    [data] => Array
        (
            [backpack] => Array
                (
                    [gold] => 50
                    [cigarettes] => 10
                )

            [vitality] => Array
                (
                    [life] => 80
                    [max_life] => 100
                    [energy] => 70
                    [max_energy] => 100
                )

        )

)

[2025-05-06 20:12:23] [DEBUG] Próba dostępu do endpointu NPC przez niezalogowanego użytkownika - ZEZWOLONO (tryb deweloperski)
[2025-05-06 20:12:23] [INFO] Szukanie pasującego dialogu dla NPC ID: 449, User ID: 1
[2025-05-06 20:12:23] [DEBUG] Tworzenie sprawdzacza warunków dla User ID: 1, NPC ID: 449
[2025-05-06 20:12:23] [INFO] Znaleziono pasujący dialog: nieznany
[2025-05-06 20:12:23] [DEBUG] Upraszczanie struktury dialogu: Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => condition_task
                            [condition] => is
                            [mission_id] => 247
                            [task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [status] => completed
                        )

                )

        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Misja
    [id_pola] => misja
    [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Tutaj dajemy odpowiedź
                    [type_anwser] => 
                    [go_to_id] => inny-dialog
                )

            [1] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Misja
                    [type_anwser] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => mission
                                    [acfe_flexible_toggle] => 
                                    [mission_id] => 247
                                    [mission_status] => in_progress
                                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [mission_task_status] => failed_npc
                                )

                        )

                    [go_to_id] => inny-dialog
                )

        )

)

[2025-05-06 20:12:23] [DEBUG] Uproszczona struktura dialogu: Array
(
    [id] => misja
    [text] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [answers] => Array
        (
            [0] => Array
                (
                    [id] => 
                    [text] => Tutaj dajemy odpowiedź
                    [next_dialog] => inny-dialog
                )

            [1] => Array
                (
                    [id] => 
                    [text] => Misja
                    [next_dialog] => inny-dialog
                )

        )

)

[2025-05-06 20:12:23] [DEBUG] Próba dostępu do endpointu NPC przez niezalogowanego użytkownika - ZEZWOLONO (tryb deweloperski)
[2025-05-06 20:12:24] [DEBUG] ===== ROZPOCZĘCIE PRZETWARZANIA ŻĄDANIA DIALOGU =====
[2025-05-06 20:12:24] [DEBUG] Żądanie dialogu: NPC ID: 449, Dialog ID: inny-dialog, User ID: 1
[2025-05-06 20:12:24] [INFO] WSZYSTKIE DANE ŻĄDANIA:
[2025-05-06 20:12:24] [DATA] Array
(
    [page_data] => Array
        (
        )

    [npc_id] => 449
    [dialog_id] => inny-dialog
    [current_url] => http://seb.soeasy.it/tereny/park/
    [user_id] => 1
    [answer_id] => answer-1
    [answer_index] => 1
    [current_dialog_id] => misja
)

[2025-05-06 20:12:24] [DEBUG] Dane odpowiedzi: ID: answer-1, Index: 1, Poprzedni dialog: misja
[2025-05-06 20:12:24] [INFO] STAN PLECAKA PRZED PRZETWARZANIEM DIALOGU:
[2025-05-06 20:12:24] [DATA] Array
(
    [gold] => 50
    [cigarettes] => 10
)

[2025-05-06 20:12:24] [INFO] Pobrane dialogi dla NPC 449
[2025-05-06 20:12:24] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_task
                                    [condition] => is
                                    [mission_id] => 247
                                    [task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [status] => completed
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Misja
            [id_pola] => misja
            [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Tutaj dajemy odpowiedź
                            [type_anwser] => 
                            [go_to_id] => inny-dialog
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Misja
                            [type_anwser] => Array
                                (
                                    [0] => Array
                                        (
                                            [acf_fc_layout] => mission
                                            [acfe_flexible_toggle] => 
                                            [mission_id] => 247
                                            [mission_status] => in_progress
                                            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                            [mission_task_status] => failed_npc
                                        )

                                )

                            [go_to_id] => inny-dialog
                        )

                )

        )

    [1] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_location
                                    [condition] => is
                                    [location_type] => text
                                    [area] => 
                                    [location_text] => park/main
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => dialog-na-zamku
            [id_pola] => dialog-na-zamku
            [question] => <p>dialog na zamku</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => elo
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [2] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_inventory
                                    [condition] => has_not_item
                                    [item_id] => 123
                                    [quantity] => 1
                                )

                            [1] => Array
                                (
                                    [acf_fc_layout] => condition_inventory
                                    [condition] => has_item
                                    [item_id] => 156
                                    [quantity] => 1
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Przedmiot
            [id_pola] => przedmiot
            [question] => <p>przedmiot</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_inventory
                                                    [condition] => quantity_above
                                                    [item_id] => 156
                                                    [quantity] => 2
                                                )

                                        )

                                )

                            [anwser_text] => przedmiot mam
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => domyslny
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [3] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_npc_relation
                                    [condition] => relation_above
                                    [npc_id] => 449
                                    [relation_value] => 50
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Dialog
            [id_pola] => lubimy-sie
            [question] => <p>Lubimy sie</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => test
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [4] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_location
                                    [condition] => is
                                    [location_type] => text
                                    [area] => 
                                    [location_text] => park/main
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => nazwa-w-parku
            [id_pola] => nazwa-w-parku
            [question] => <p>Dialog w parku</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_location
                                                    [condition] => is
                                                    [location_type] => text
                                                    [area] => 
                                                    [location_text] => park/main
                                                )

                                        )

                                )

                            [anwser_text] => Odpowiedź w parku
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_location
                                                    [condition] => is
                                                    [location_type] => text
                                                    [area] => 
                                                    [location_text] => park/zamek
                                                )

                                        )

                                )

                            [anwser_text] => odpowiedź w zamku
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [2] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Domyślna
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [5] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => domyslny
            [id_pola] => domyslny
            [question] => <p>Domyślny</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => domyslne
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [6] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Dialog
            [id_pola] => inny-dialog
            [question] => <p>tutaj inny dialog</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => ok
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

)

[2025-05-06 20:12:24] [INFO] Wyodrębnione dane lokalizacji:
[2025-05-06 20:12:24] [DATA] Array
(
    [location] => Array
        (
            [area_slug] => park
            [area_name] => Park
            [area_id] => 207
        )

    [type_page] => 
    [location_value] => 
)

[2025-05-06 20:12:24] [DEBUG] ROZPOCZYNAM PRZETWARZANIE PRZYCISKÓW ODPOWIEDZI
[2025-05-06 20:12:24] [DEBUG] Znaleziono dialog o ID: misja
[2025-05-06 20:12:24] [DEBUG] Znaleziono poprzedni dialog ID: misja
[2025-05-06 20:12:24] [INFO] Pełne dane dialogu:
[2025-05-06 20:12:24] [DATA] Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => condition_task
                            [condition] => is
                            [mission_id] => 247
                            [task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [status] => completed
                        )

                )

        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Misja
    [id_pola] => misja
    [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Tutaj dajemy odpowiedź
                    [type_anwser] => 
                    [go_to_id] => inny-dialog
                )

            [1] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Misja
                    [type_anwser] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => mission
                                    [acfe_flexible_toggle] => 
                                    [mission_id] => 247
                                    [mission_status] => in_progress
                                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [mission_task_status] => failed_npc
                                )

                        )

                    [go_to_id] => inny-dialog
                )

        )

)

[2025-05-06 20:12:24] [INFO] Odpowiedzi w dialogu:
[2025-05-06 20:12:24] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => anwser
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [anwser_text] => Tutaj dajemy odpowiedź
            [type_anwser] => 
            [go_to_id] => inny-dialog
        )

    [1] => Array
        (
            [acf_fc_layout] => anwser
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [anwser_text] => Misja
            [type_anwser] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => mission
                            [acfe_flexible_toggle] => 
                            [mission_id] => 247
                            [mission_status] => in_progress
                            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [mission_task_status] => failed_npc
                        )

                )

            [go_to_id] => inny-dialog
        )

)

[2025-05-06 20:12:24] [DEBUG] Znaleziono odpowiedź o indeksie: 1
[2025-05-06 20:12:24] [INFO] Dane odpowiedzi:
[2025-05-06 20:12:24] [DATA] Array
(
    [acf_fc_layout] => anwser
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [anwser_text] => Misja
    [type_anwser] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => mission
                    [acfe_flexible_toggle] => 
                    [mission_id] => 247
                    [mission_status] => in_progress
                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                    [mission_task_status] => failed_npc
                )

        )

    [go_to_id] => inny-dialog
)

[2025-05-06 20:12:24] [INFO] Odpowiedź zawiera akcje do wykonania:
[2025-05-06 20:12:24] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => mission
            [acfe_flexible_toggle] => 
            [mission_id] => 247
            [mission_status] => in_progress
            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
            [mission_task_status] => failed_npc
        )

)

[2025-05-06 20:12:24] [INFO] Przetwarzanie akcji:
[2025-05-06 20:12:24] [DATA] Array
(
    [acf_fc_layout] => mission
    [acfe_flexible_toggle] => 
    [mission_id] => 247
    [mission_status] => in_progress
    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
    [mission_task_status] => failed_npc
)

[2025-05-06 20:12:24] [DEBUG] Typ akcji: mission
[2025-05-06 20:12:24] [DEBUG] Wykonuję akcję misji: mission_id=247, status=in_progress, task_id=zidentyfikuj-potencjalnych-klientow_0, task_status=failed_npc, npc_id=449
[2025-05-06 20:12:24] [INFO] Aktualny stan misji użytkownika:
[2025-05-06 20:12:24] [DATA] Array
(
    [status] => in_progress
    [assigned_date] => 2025-04-27 13:05:30
    [completion_date] => 2025-04-29 16:43:16
    [tasks] => Array
        (
            [zidentyfikuj-potencjalnych-klientow_0] => Array
                (
                    [status] => completed
                    [npc_target_449] => in_progress
                    [npc_449] => in_progress
                )

            [rozlicz-sie-z-irasem_1] => not_started
        )

)

[2025-05-06 20:12:24] [DEBUG] Zaktualizowano status misji 'Flaszki od Dziadzi' z 'in_progress' na 'in_progress'
[2025-05-06 20:12:24] [DEBUG] Rozpoznano zadanie z NPC: task_id=zidentyfikuj-potencjalnych-klientow_0, npc_id=449
[2025-05-06 20:12:24] [DEBUG] Zaktualizowano status NPC 449 w zadaniu 'zidentyfikuj-potencjalnych-klientow_0' z 'in_progress' na 'failed'
[2025-05-06 20:12:24] [DEBUG] Rezultat update_field dla misji mission_247: BŁĄD
[2025-05-06 20:12:24] [INFO] Stan misji po aktualizacji:
[2025-05-06 20:12:24] [DATA] Array
(
    [status] => in_progress
    [assigned_date] => 2025-04-27 13:05:30
    [completion_date] => 2025-04-29 16:43:16
    [tasks] => Array
        (
            [zidentyfikuj-potencjalnych-klientow_0] => Array
                (
                    [status] => completed
                    [npc_target_449] => failed
                    [npc_449] => failed
                )

            [rozlicz-sie-z-irasem_1] => not_started
        )

)

[2025-05-06 20:12:24] [INFO] Utworzono powiadomienie dla misji:
[2025-05-06 20:12:24] [DATA] Array
(
    [message] => Nie udało się wykonać zadania: zidentyfikuj-potencjalnych-klientow_0
    [status] => bad
)

[2025-05-06 20:12:24] [INFO] Dialog po filtrowaniu:
[2025-05-06 20:12:24] [DATA] Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Dialog
    [id_pola] => inny-dialog
    [question] => <p>tutaj inny dialog</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => ok
                    [type_anwser] => 
                    [go_to_id] => 0
                )

        )

)

[2025-05-06 20:12:24] [DEBUG] Upraszczanie struktury dialogu: Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Dialog
    [id_pola] => inny-dialog
    [question] => <p>tutaj inny dialog</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => ok
                    [type_anwser] => 
                    [go_to_id] => 0
                )

        )

)

[2025-05-06 20:12:24] [DEBUG] Uproszczona struktura dialogu: Array
(
    [id] => inny-dialog
    [text] => <p>tutaj inny dialog</p>

    [answers] => Array
        (
            [0] => Array
                (
                    [id] => 
                    [text] => ok
                    [next_dialog] => 0
                )

        )

)

[2025-05-06 20:12:24] [INFO] Dodano powiadomienie do odpowiedzi:
[2025-05-06 20:12:24] [DATA] Array
(
    [message] => Nie udało się wykonać zadania: zidentyfikuj-potencjalnych-klientow_0
    [status] => bad
)

[2025-05-06 20:12:24] [INFO] Dane odpowiedzi:
[2025-05-06 20:12:24] [DATA] Array
(
    [success] => 1
    [dialog] => Array
        (
            [id] => inny-dialog
            [text] => <p>tutaj inny dialog</p>

            [answers] => Array
                (
                    [0] => Array
                        (
                            [id] => 
                            [text] => ok
                            [next_dialog] => 0
                        )

                )

        )

    [npc] => Array
        (
            [id] => 449
            [name] => Papuga
            [image] => http://seb.soeasy.it/wp-content/uploads/2025/04/papuga-1.png
        )

    [notification] => Array
        (
            [message] => Nie udało się wykonać zadania: zidentyfikuj-potencjalnych-klientow_0
            [status] => bad
        )

)

[2025-05-06 20:12:24] [DEBUG] ===== ZAKOŃCZENIE PRZETWARZANIA ŻĄDANIA DIALOGU =====
[2025-05-06 20:12:24] [DEBUG] Obsługa żądania danych użytkownika ID: 1
[2025-05-06 20:12:24] [INFO] Pobrano dane plecaka użytkownika:
[2025-05-06 20:12:24] [DATA] Array
(
    [gold] => 50
    [cigarettes] => 10
)

[2025-05-06 20:12:24] [INFO] Pobrano dane witalności użytkownika:
[2025-05-06 20:12:24] [DATA] Array
(
    [life] => 80
    [max_life] => 100
    [energy] => 70
    [max_energy] => 100
)

[2025-05-06 20:12:24] [INFO] Zwracam dane użytkownika:
[2025-05-06 20:12:24] [DATA] Array
(
    [success] => 1
    [message] => Dane użytkownika pobrane pomyślnie
    [data] => Array
        (
            [backpack] => Array
                (
                    [gold] => 50
                    [cigarettes] => 10
                )

            [vitality] => Array
                (
                    [life] => 80
                    [max_life] => 100
                    [energy] => 70
                    [max_energy] => 100
                )

        )

)

[2025-05-06 20:12:39] [DEBUG] Próba dostępu do endpointu NPC przez niezalogowanego użytkownika - ZEZWOLONO (tryb deweloperski)
[2025-05-06 20:12:39] [INFO] Szukanie pasującego dialogu dla NPC ID: 449, User ID: 1
[2025-05-06 20:12:39] [DEBUG] Tworzenie sprawdzacza warunków dla User ID: 1, NPC ID: 449
[2025-05-06 20:12:39] [INFO] Znaleziono pasujący dialog: nieznany
[2025-05-06 20:12:39] [DEBUG] Upraszczanie struktury dialogu: Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => condition_task
                            [condition] => is
                            [mission_id] => 247
                            [task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [status] => completed
                        )

                )

        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Misja
    [id_pola] => misja
    [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Tutaj dajemy odpowiedź
                    [type_anwser] => 
                    [go_to_id] => inny-dialog
                )

            [1] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Misja
                    [type_anwser] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => mission
                                    [acfe_flexible_toggle] => 
                                    [mission_id] => 247
                                    [mission_status] => in_progress
                                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [mission_task_status] => completed_npc
                                )

                        )

                    [go_to_id] => inny-dialog
                )

        )

)

[2025-05-06 20:12:39] [DEBUG] Uproszczona struktura dialogu: Array
(
    [id] => misja
    [text] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [answers] => Array
        (
            [0] => Array
                (
                    [id] => 
                    [text] => Tutaj dajemy odpowiedź
                    [next_dialog] => inny-dialog
                )

            [1] => Array
                (
                    [id] => 
                    [text] => Misja
                    [next_dialog] => inny-dialog
                )

        )

)

[2025-05-06 20:12:39] [DEBUG] Próba dostępu do endpointu NPC przez niezalogowanego użytkownika - ZEZWOLONO (tryb deweloperski)
[2025-05-06 20:12:41] [DEBUG] ===== ROZPOCZĘCIE PRZETWARZANIA ŻĄDANIA DIALOGU =====
[2025-05-06 20:12:41] [DEBUG] Żądanie dialogu: NPC ID: 449, Dialog ID: inny-dialog, User ID: 1
[2025-05-06 20:12:41] [INFO] WSZYSTKIE DANE ŻĄDANIA:
[2025-05-06 20:12:41] [DATA] Array
(
    [page_data] => Array
        (
        )

    [npc_id] => 449
    [dialog_id] => inny-dialog
    [current_url] => http://seb.soeasy.it/tereny/park/
    [user_id] => 1
    [answer_id] => answer-1
    [answer_index] => 1
    [current_dialog_id] => misja
)

[2025-05-06 20:12:41] [DEBUG] Dane odpowiedzi: ID: answer-1, Index: 1, Poprzedni dialog: misja
[2025-05-06 20:12:41] [INFO] STAN PLECAKA PRZED PRZETWARZANIEM DIALOGU:
[2025-05-06 20:12:41] [DATA] Array
(
    [gold] => 50
    [cigarettes] => 10
)

[2025-05-06 20:12:41] [INFO] Pobrane dialogi dla NPC 449
[2025-05-06 20:12:41] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_task
                                    [condition] => is
                                    [mission_id] => 247
                                    [task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [status] => completed
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Misja
            [id_pola] => misja
            [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Tutaj dajemy odpowiedź
                            [type_anwser] => 
                            [go_to_id] => inny-dialog
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Misja
                            [type_anwser] => Array
                                (
                                    [0] => Array
                                        (
                                            [acf_fc_layout] => mission
                                            [acfe_flexible_toggle] => 
                                            [mission_id] => 247
                                            [mission_status] => in_progress
                                            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                            [mission_task_status] => completed_npc
                                        )

                                )

                            [go_to_id] => inny-dialog
                        )

                )

        )

    [1] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_location
                                    [condition] => is
                                    [location_type] => text
                                    [area] => 
                                    [location_text] => park/main
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => dialog-na-zamku
            [id_pola] => dialog-na-zamku
            [question] => <p>dialog na zamku</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => elo
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [2] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_inventory
                                    [condition] => has_not_item
                                    [item_id] => 123
                                    [quantity] => 1
                                )

                            [1] => Array
                                (
                                    [acf_fc_layout] => condition_inventory
                                    [condition] => has_item
                                    [item_id] => 156
                                    [quantity] => 1
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Przedmiot
            [id_pola] => przedmiot
            [question] => <p>przedmiot</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_inventory
                                                    [condition] => quantity_above
                                                    [item_id] => 156
                                                    [quantity] => 2
                                                )

                                        )

                                )

                            [anwser_text] => przedmiot mam
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => domyslny
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [3] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_npc_relation
                                    [condition] => relation_above
                                    [npc_id] => 449
                                    [relation_value] => 50
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Dialog
            [id_pola] => lubimy-sie
            [question] => <p>Lubimy sie</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => test
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [4] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => condition_location
                                    [condition] => is
                                    [location_type] => text
                                    [area] => 
                                    [location_text] => park/main
                                )

                        )

                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => nazwa-w-parku
            [id_pola] => nazwa-w-parku
            [question] => <p>Dialog w parku</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_location
                                                    [condition] => is
                                                    [location_type] => text
                                                    [area] => 
                                                    [location_text] => park/main
                                                )

                                        )

                                )

                            [anwser_text] => Odpowiedź w parku
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [1] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [acf_fc_layout] => condition_location
                                                    [condition] => is
                                                    [location_type] => text
                                                    [area] => 
                                                    [location_text] => park/zamek
                                                )

                                        )

                                )

                            [anwser_text] => odpowiedź w zamku
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                    [2] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => Domyślna
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [5] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => domyslny
            [id_pola] => domyslny
            [question] => <p>Domyślny</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => domyslne
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

    [6] => Array
        (
            [acf_fc_layout] => question
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [acfe_flexible_toggle] => 
            [acfe_flexible_layout_title] => Dialog
            [id_pola] => inny-dialog
            [question] => <p>tutaj inny dialog</p>

            [anwsers] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => anwser
                            [layout_settings] => Array
                                (
                                    [visibility_tab] => 
                                    [logic_operator] => and
                                    [visibility_settings] => 
                                )

                            [anwser_text] => ok
                            [type_anwser] => 
                            [go_to_id] => 0
                        )

                )

        )

)

[2025-05-06 20:12:41] [INFO] Wyodrębnione dane lokalizacji:
[2025-05-06 20:12:41] [DATA] Array
(
    [location] => Array
        (
            [area_slug] => park
            [area_name] => Park
            [area_id] => 207
        )

    [type_page] => 
    [location_value] => 
)

[2025-05-06 20:12:41] [DEBUG] ROZPOCZYNAM PRZETWARZANIE PRZYCISKÓW ODPOWIEDZI
[2025-05-06 20:12:41] [DEBUG] Znaleziono dialog o ID: misja
[2025-05-06 20:12:41] [DEBUG] Znaleziono poprzedni dialog ID: misja
[2025-05-06 20:12:41] [INFO] Pełne dane dialogu:
[2025-05-06 20:12:41] [DATA] Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => condition_task
                            [condition] => is
                            [mission_id] => 247
                            [task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [status] => completed
                        )

                )

        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Misja
    [id_pola] => misja
    [question] => <p>Tutaj dajemy jakiś <strong>rozbudowany opis</strong> misji</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Tutaj dajemy odpowiedź
                    [type_anwser] => 
                    [go_to_id] => inny-dialog
                )

            [1] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => Misja
                    [type_anwser] => Array
                        (
                            [0] => Array
                                (
                                    [acf_fc_layout] => mission
                                    [acfe_flexible_toggle] => 
                                    [mission_id] => 247
                                    [mission_status] => in_progress
                                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                                    [mission_task_status] => completed_npc
                                )

                        )

                    [go_to_id] => inny-dialog
                )

        )

)

[2025-05-06 20:12:41] [INFO] Odpowiedzi w dialogu:
[2025-05-06 20:12:41] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => anwser
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [anwser_text] => Tutaj dajemy odpowiedź
            [type_anwser] => 
            [go_to_id] => inny-dialog
        )

    [1] => Array
        (
            [acf_fc_layout] => anwser
            [layout_settings] => Array
                (
                    [visibility_tab] => 
                    [logic_operator] => and
                    [visibility_settings] => 
                )

            [anwser_text] => Misja
            [type_anwser] => Array
                (
                    [0] => Array
                        (
                            [acf_fc_layout] => mission
                            [acfe_flexible_toggle] => 
                            [mission_id] => 247
                            [mission_status] => in_progress
                            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                            [mission_task_status] => completed_npc
                        )

                )

            [go_to_id] => inny-dialog
        )

)

[2025-05-06 20:12:41] [DEBUG] Znaleziono odpowiedź o indeksie: 1
[2025-05-06 20:12:41] [INFO] Dane odpowiedzi:
[2025-05-06 20:12:41] [DATA] Array
(
    [acf_fc_layout] => anwser
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [anwser_text] => Misja
    [type_anwser] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => mission
                    [acfe_flexible_toggle] => 
                    [mission_id] => 247
                    [mission_status] => in_progress
                    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
                    [mission_task_status] => completed_npc
                )

        )

    [go_to_id] => inny-dialog
)

[2025-05-06 20:12:41] [INFO] Odpowiedź zawiera akcje do wykonania:
[2025-05-06 20:12:41] [DATA] Array
(
    [0] => Array
        (
            [acf_fc_layout] => mission
            [acfe_flexible_toggle] => 
            [mission_id] => 247
            [mission_status] => in_progress
            [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
            [mission_task_status] => completed_npc
        )

)

[2025-05-06 20:12:41] [INFO] Przetwarzanie akcji:
[2025-05-06 20:12:41] [DATA] Array
(
    [acf_fc_layout] => mission
    [acfe_flexible_toggle] => 
    [mission_id] => 247
    [mission_status] => in_progress
    [mission_task_id] => zidentyfikuj-potencjalnych-klientow_0
    [mission_task_status] => completed_npc
)

[2025-05-06 20:12:41] [DEBUG] Typ akcji: mission
[2025-05-06 20:12:41] [DEBUG] Wykonuję akcję misji: mission_id=247, status=in_progress, task_id=zidentyfikuj-potencjalnych-klientow_0, task_status=completed_npc, npc_id=449
[2025-05-06 20:12:41] [INFO] Aktualny stan misji użytkownika:
[2025-05-06 20:12:41] [DATA] Array
(
    [status] => in_progress
    [assigned_date] => 2025-04-27 13:05:30
    [completion_date] => 2025-04-29 16:43:16
    [tasks] => Array
        (
            [zidentyfikuj-potencjalnych-klientow_0] => Array
                (
                    [status] => not_started
                    [npc_target_449] => completed
                    [npc_449] => failed
                )

            [rozlicz-sie-z-irasem_1] => not_started
        )

)

[2025-05-06 20:12:41] [DEBUG] Zaktualizowano status misji 'Flaszki od Dziadzi' z 'in_progress' na 'in_progress'
[2025-05-06 20:12:41] [DEBUG] Rozpoznano zadanie z NPC: task_id=zidentyfikuj-potencjalnych-klientow_0, npc_id=449
[2025-05-06 20:12:41] [DEBUG] Zaktualizowano status NPC 449 w zadaniu 'zidentyfikuj-potencjalnych-klientow_0' z 'failed' na 'completed'
[2025-05-06 20:12:41] [DEBUG] Wszystkie NPC ukończone, aktualizuję ogólny status zadania 'zidentyfikuj-potencjalnych-klientow_0' z 'not_started' na 'completed'
[2025-05-06 20:12:41] [DEBUG] Rezultat update_field dla misji mission_247: BŁĄD
[2025-05-06 20:12:41] [INFO] Stan misji po aktualizacji:
[2025-05-06 20:12:41] [DATA] Array
(
    [status] => in_progress
    [assigned_date] => 2025-04-27 13:05:30
    [completion_date] => 2025-04-29 16:43:16
    [tasks] => Array
        (
            [zidentyfikuj-potencjalnych-klientow_0] => Array
                (
                    [status] => completed
                    [npc_target_449] => completed
                    [npc_449] => completed
                )

            [rozlicz-sie-z-irasem_1] => not_started
        )

)

[2025-05-06 20:12:41] [INFO] Utworzono powiadomienie dla misji:
[2025-05-06 20:12:41] [DATA] Array
(
    [message] => Ukończono zadanie: zidentyfikuj-potencjalnych-klientow_0
    [status] => success
)

[2025-05-06 20:12:41] [INFO] Dialog po filtrowaniu:
[2025-05-06 20:12:41] [DATA] Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Dialog
    [id_pola] => inny-dialog
    [question] => <p>tutaj inny dialog</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => ok
                    [type_anwser] => 
                    [go_to_id] => 0
                )

        )

)

[2025-05-06 20:12:41] [DEBUG] Upraszczanie struktury dialogu: Array
(
    [acf_fc_layout] => question
    [layout_settings] => Array
        (
            [visibility_tab] => 
            [logic_operator] => and
            [visibility_settings] => 
        )

    [acfe_flexible_toggle] => 
    [acfe_flexible_layout_title] => Dialog
    [id_pola] => inny-dialog
    [question] => <p>tutaj inny dialog</p>

    [anwsers] => Array
        (
            [0] => Array
                (
                    [acf_fc_layout] => anwser
                    [layout_settings] => Array
                        (
                            [visibility_tab] => 
                            [logic_operator] => and
                            [visibility_settings] => 
                        )

                    [anwser_text] => ok
                    [type_anwser] => 
                    [go_to_id] => 0
                )

        )

)

[2025-05-06 20:12:41] [DEBUG] Uproszczona struktura dialogu: Array
(
    [id] => inny-dialog
    [text] => <p>tutaj inny dialog</p>

    [answers] => Array
        (
            [0] => Array
                (
                    [id] => 
                    [text] => ok
                    [next_dialog] => 0
                )

        )

)

[2025-05-06 20:12:41] [INFO] Dodano powiadomienie do odpowiedzi:
[2025-05-06 20:12:41] [DATA] Array
(
    [message] => Ukończono zadanie: zidentyfikuj-potencjalnych-klientow_0
    [status] => success
)

[2025-05-06 20:12:41] [INFO] Dane odpowiedzi:
[2025-05-06 20:12:41] [DATA] Array
(
    [success] => 1
    [dialog] => Array
        (
            [id] => inny-dialog
            [text] => <p>tutaj inny dialog</p>

            [answers] => Array
                (
                    [0] => Array
                        (
                            [id] => 
                            [text] => ok
                            [next_dialog] => 0
                        )

                )

        )

    [npc] => Array
        (
            [id] => 449
            [name] => Papuga
            [image] => http://seb.soeasy.it/wp-content/uploads/2025/04/papuga-1.png
        )

    [notification] => Array
        (
            [message] => Ukończono zadanie: zidentyfikuj-potencjalnych-klientow_0
            [status] => success
        )

)

[2025-05-06 20:12:41] [DEBUG] ===== ZAKOŃCZENIE PRZETWARZANIA ŻĄDANIA DIALOGU =====
[2025-05-06 20:12:41] [DEBUG] Obsługa żądania danych użytkownika ID: 1
[2025-05-06 20:12:41] [INFO] Pobrano dane plecaka użytkownika:
[2025-05-06 20:12:41] [DATA] Array
(
    [gold] => 50
    [cigarettes] => 10
)

[2025-05-06 20:12:41] [INFO] Pobrano dane witalności użytkownika:
[2025-05-06 20:12:41] [DATA] Array
(
    [life] => 80
    [max_life] => 100
    [energy] => 70
    [max_energy] => 100
)

[2025-05-06 20:12:41] [INFO] Zwracam dane użytkownika:
[2025-05-06 20:12:41] [DATA] Array
(
    [success] => 1
    [message] => Dane użytkownika pobrane pomyślnie
    [data] => Array
        (
            [backpack] => Array
                (
                    [gold] => 50
                    [cigarettes] => 10
                )

            [vitality] => Array
                (
                    [life] => 80
                    [max_life] => 100
                    [energy] => 70
                    [max_energy] => 100
                )

        )

)

